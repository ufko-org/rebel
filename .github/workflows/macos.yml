name: macOS Rebel build & QA test

on: [push, pull_request]

jobs:
  build:
    runs-on: macos-15-intel

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Install dependencies
        run: |
          brew install libffi 
          # readline is installed by default

      - name: Build rebel using Makefile.macos
        run: |
          cd src
          make -f Makefile.macos clean
          make -f Makefile.macos
          ./rebel qa-dot

#      - name: Run -q test
#        run: |
#          cd examples
#          echo -e "Running ./rebel -q"
#          ../src/rebel -q 00-hello.rbl
#      - name: Run regression tests in tests/ folder
#        run: | 
#          cd tests
#          echo -e "Running ./rebel *.test.rbl:"
#          ../src/rebel *.test.rbl
