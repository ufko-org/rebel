; Test for function "cpymem"
; ------------------------------------------------------------
(load "testing.rbl")
(context 'test)

; Basic memory copy
; ------------------------------------------------------------
(test "1: cpymem copies 5 bytes from string to string"
  (begin
    (set 'from "12345")
    (set 'to   "     ")
    (cpymem (address from) (address to) 5)
    (= from to)
  )
  true
)

; Copy shorter segment
; ------------------------------------------------------------
(test "2: cpymem copies first 3 bytes only"
  (begin
    (set 'from "abcde")
    (set 'to   "xxxxx")
    (cpymem (address from) (address to) 3)
    (= to "abcxx")
  )
  true
)

; Idempotent when source and destination match
; ------------------------------------------------------------
(test "3: cpymem with same string leaves it unchanged"
  (begin
    (set 's "hello")
    (cpymem (address s) (address s) 5)
    (= s "hello")
  )
  true
)
