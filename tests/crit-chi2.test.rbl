; Test for function "crit-chi2" (with prob-chi2)
; ------------------------------------------------------------
(load "testing.rbl")
(context 'test)

; Inversion property: crit-chi2(prob-chi2(x,df),df) â‰ˆ x
; ------------------------------------------------------------
(test "1: inversion check df=2, x=4.605"
  (< (abs (sub (crit-chi2 (prob-chi2 4.605 2) 2) 4.605)) 0.001)
  true
)

(test "2: inversion check df=40, x=51.805"
  (< (abs (sub (crit-chi2 (prob-chi2 51.805 40) 40) 51.805)) 0.001)
  true
)

(test "3: inversion check df=2, x=9.210"
  (< (abs (sub (crit-chi2 (prob-chi2 9.210 2) 2) 9.210)) 0.001)
  true
)

(test "4: inversion check df=40, x=63.691"
  (< (abs (sub (crit-chi2 (prob-chi2 63.691 40) 40) 63.691)) 0.001)
  true
)
